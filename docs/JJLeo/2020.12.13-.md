# 2020.12.13-

## **CF1461E**

### 题意

一个饮水机，在 $t$ 天的时间内，每天一开始可以选择是否加 $y$ 升水，这一天会固定消耗 $x$ 升水，初始水量为 $k$，问是否存在一种方案使得水量任意时刻处于 $[l,r]$ 升内。($1 \le l \le k \le r \le 10^{18}; 1 \le t \le 10^{18}; 1 \le x \le 10^6; 1 \le y \le 10^{18}$)

### 题解

- 如果 $y \le x$，那么水量会一直不增且加水不会超上限，因此能加水就加水。当然第一天可能加水会超出限制，特判掉这个情况，之后算一下天数够不够即可。
- 如果 $y > x$，观察到 $x$ 的数据范围与众不同，可以从这里下手：最优情况一定是让水量减少到不能减少然后再加一次水，每次加水相当于改变水量模 $x$ 的值，因此如果出现循环那么就可以持续无限天，反之如果某一次加水超出上限就无法继续了。可以使用 `map` 记录，最多 ${10}^6$ 天就可以得到答案。需要注意的是，有可能最终不能无限循环，但是持续的天数 $\ge t$，那么也是可以的，需要每次循环减掉天数来判断。

## **CF1461F**

### 题意

给定一个长度为 $n$ 的十进制串和 $\{+,-,\times\}$ 的一个子集 $S$，在 $n-1$ 个空隙加入 $S$ 中的符号使得最终表达式结果最大，从左往右运算，乘号优先级最高，加减法优先级相同。($1 \le n \le 10^5$)

### 题解

- $|S| = 1$，没有选择。

- $S = \{+,-\}$，全放加号即可。

- $S = \{\times,-\}$，仔细想想可以发现最优方案是在第一个 $0$ 前面放减号，其它位置全部放乘号。

- $\{+,\times \} \subseteq S$，首先 $0$ 左右必然是加号，先按 $0$ 分段；每一段的前缀 $1$ 和后缀 $1$ 也必然左右都是加号，对于中间的部分，有如下结论，如果
  $$
  \prod_{i=1}^na_i \ge 2n
  $$
  则最优方案是全部放乘号，证明见 [这里](https://www.cnblogs.com/Grice/p/14129545.html)。

  因此如果上式不成立，那么中间部分不为 $1$ 的数只有 $O(\log n)$ 个，可以使用如下的 dp：

  - 设 $f_i$ 是只考虑前 $i$ 个数，且 $a_i$ 和 $a_{i+1}$ 符号为加号的最大值。

  - 如果 $a_{i+1} = 1$，那么有 $f_i+1 \to f_{i+1}$。

  - 如果一段数中间的符号均为乘号，那么其首尾必然都不是 $1$，因此有
    $$
    f_i + \prod_{k=i+1}^j a_k \to f_j
    $$
    其中 $j>i,a_j > 1$。

  - 时间复杂度为 $O(n \log n)$。  

    