# 2020.12.13-

## **CF1455E**

### 题意

给定二维平面上四个点，可以将它们水平或竖直移动，将它们移动到一个正方形的四角最少需要移动多少距离。

### 题解

全排列枚举四个点和四个角（左上、左下、右上、右下）的对应关系，那么左上左下的两个点（和右上右下的两个点）最终移动到的点的横坐标一定位于它们两者中间，此时可以算出水平边的边长范围；同样左上右上的两个点（和左下右下的两个点）最终移动到的点的纵坐标一定位于它们两者中间，此时可以算出竖直边的边长范围。如果两者有交集，则不需要额外移动；否则其中两个点需要额外移动中间差着的距离（这里可以使用 $\min(|\max_1-\min_2|,|\max_2-\min_1|)$ 来快速求得）。

上述过程的形象化图片可以参考这篇 [题解](https://blog.csdn.net/qq_41765114/article/details/110506665)。

## **CF1455F**

### 题意

$t$ 组数据，给定一个长度为 $n$ 的字符串，字符集为前 $k$ 个小写字母，依次选择**原来**第 $i$ 个字符选择如下操作：

- 按字典序循环左移一位。
- 按字典序循环右移一位。
- 和左侧字符交换。（如果有）
- 和右侧字符交换。（如果有）
- 不进行任何改动。

求最终得到的字典序最小的字符串。($1 \le t \le 1000$，$1 \le n \le 500$，$2 \le k \le 26$)

### 题解

数据范围比较小，直接设 $f_i$ 是前 $i$ 个字符都操作过后得到的长度为 $i$ 的**字符串**，使用 `string` 存储，考虑如下的转移：

- 直接通过循环位移或是不进行改动让当前这一位更小：$f_i + \min s_{i+1} \to f_{i+1}$。
- 向左移动一位：$f_{i}[1 \cdots i-1] + s_{i+1} + f_i[i] \to f_{i+1}$。
- 向右移动一位，下一位选择变为最小：$f_i + \min s_{i+2} + s_{i+1} \to f_{i+1}$。
- 向右移动一位，下一位向左移动一位：$f_{i}[1 \cdots i-1] + s_{i+2} + f_i[i] + s_{i+1}\to f_{i+1}$。

最终答案为 $f_n$，时间复杂度为 $O(n^2)$，这题很巧妙地使用 `string` 当作状态避开了各种复杂的讨论，官方题解指出因为每个状态变化的字符量为 $O(1)$，还可以使用主席树+哈希在 $O(n \log n)$ 时间内解决。（网上还有更快但是也更复杂的 $O(n)$ 做法）

## **CF1455G**

### 题意

有一个变量 $x$，初始值为 $0$，给定 $n$ 行代码，由如下两种形式组成：

- `set` $y$ $v$，将 $x$ 设为 $y$，或支付 $v$ 使 $x$ 的值不变。
- `if` $y$ $\cdots$ `end`，如果 $x=y$ 就进入这个代码块，否则跳过。保证 `if` 和 `end` 一一对应。

必须保证任意时刻 $x$ 不为 $s$，求最小花费。($1 \le n \le 2 \cdot 10^5$，$0 \le y \le 2 \cdot 10^5$，$1 \le v \le 10^9$)

### 题解

设 $f_{i,j}$ 为执行完第 $i$ 行，$x=j$ 的最小花费，对于 `set` 语句，有：

$$
f_{i,j} = 
\begin{cases}
\min \limits _{k=0} ^ {2 \cdot 10^5} f_{i-1,k}, &j=y \newline
f_{i-1,j} + v, &j \ne y
\end{cases}
$$

一开始仅有 $f_{0,0} = 0$，其它均为 $+ \infty$，而每一行至多增加一个新的有意义的状态，因此总状态数是 $O(n)$ 的，只需维护一个全局的增量和全局最小值即可。

对于 `if` 语句，相当于一个新的子问题，初始状态为 $f_{i,y} = f_{i-1,y}$，其它均为 $+ \infty$。

对于 `end` 语句，需要将子问题和原问题进行合并，设 $p,q$ 分别为 `if` 前和 `if` 内最后一行的行数，有：
$$
f_{i,j} = 
\begin{cases}
f_{q,j}, &j=y \newline
\min(f_{p,j},f_{q,j}), &j \ne y
\end{cases}
$$
使用 `map` 存状态，`multiset` 存全局最小值，使用启发式合并，时间复杂度为 $O(n \log ^2 n)$。

## **CF1461E**

### 题意

一个饮水机，在 $t$ 天的时间内，每天一开始可以选择是否加 $y$ 升水，这一天会固定消耗 $x$ 升水，初始水量为 $k$，问是否存在一种方案使得水量任意时刻处于 $[l,r]$ 升内。($1 \le l \le k \le r \le 10^{18}; 1 \le t \le 10^{18}; 1 \le x \le 10^6; 1 \le y \le 10^{18}$)

### 题解

- 如果 $y \le x$，那么水量会一直不增且加水不会超上限，因此能加水就加水。当然第一天可能加水会超出限制，特判掉这个情况，之后算一下天数够不够即可。
- 如果 $y > x$，观察到 $x$ 的数据范围与众不同，可以从这里下手：最优情况一定是让水量减少到不能减少然后再加一次水，每次加水相当于改变水量模 $x$ 的值，因此如果出现循环那么就可以持续无限天，反之如果某一次加水超出上限就无法继续了。可以使用 `map` 记录，最多 ${10}^6$ 天就可以得到答案。需要注意的是，有可能最终不能无限循环，但是持续的天数 $\ge t$，那么也是可以的，需要每次循环减掉天数来判断。

## **CF1461F**

### 题意

给定一个长度为 $n$ 的十进制串和 $\{+,-,\times\}$ 的一个子集 $S$，在 $n-1$ 个空隙加入 $S$ 中的符号使得最终表达式结果最大，从左往右运算，乘号优先级最高，加减法优先级相同。($1 \le n \le 10^5$)

### 题解

- $|S| = 1$，没有选择。

- $S = \{+,-\}$，全放加号即可。

- $S = \{\times,-\}$，仔细想想可以发现最优方案是在第一个 $0$ 前面放减号，其它位置全部放乘号。

- $\{+,\times \} \subseteq S$，首先 $0$ 左右必然是加号，先按 $0$ 分段；每一段的前缀 $1$ 和后缀 $1$ 也必然左右都是加号，对于中间的部分，有如下结论，如果
  $$
  \prod_{i=1}^na_i \ge 2n
  $$
  则最优方案是全部放乘号，证明见 [这里](https://www.cnblogs.com/Grice/p/14129545.html)。

  因此如果上式不成立，那么中间部分不为 $1$ 的数只有 $O(\log n)$ 个，可以使用如下的 dp：

  - 设 $f_i$ 是只考虑前 $i$ 个数，且 $a_i$ 和 $a_{i+1}$ 符号为加号的最大值。

  - 如果 $a_{i+1} = 1$，那么有 $f_i+1 \to f_{i+1}$。

  - 如果一段数中间的符号均为乘号，那么其首尾必然都不是 $1$，因此有
    $$
    f_i + \prod_{k=i+1}^j a_k \to f_j
    $$
    其中 $j>i,a_j > 1$。

  - 时间复杂度为 $O(n \log n)$。  

    